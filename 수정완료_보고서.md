# ğŸ”§ MY SPORT í”„ë¡œì íŠ¸ ìˆ˜ì • ì™„ë£Œ ë³´ê³ ì„œ

## ğŸ“‹ ìˆ˜ì • ê°œìš”

**ì‘ì—… ì¼ì‹œ:** 2025-01-14  
**ìˆ˜ì • íŒŒì¼ ìˆ˜:** 7ê°œ  
**ìƒíƒœ:** âœ… ìˆ˜ì • ì™„ë£Œ

---

## ğŸš¨ ë°œê²¬ëœ ë¬¸ì œì 

### 1. **Cron ìŠ¤ì¼€ì¤„ ë¬¸ë²• ì˜¤ë¥˜**
- **íŒŒì¼:** `.github/workflows/crawl-baseball.yml`
- **ë¬¸ì œ:** `- cron: '0 1 * 11-12,1-2 * 1'` (ë§ˆì§€ë§‰ `1`ì˜ ìœ„ì¹˜ ì˜¤ë¥˜)
- **í•´ê²°:** `- cron: '0 1 * 11-12,1-2 *'` ë° `- cron: '0 1 * * 1'`ë¡œ ìˆ˜ì •

### 2. **ì¤‘ë³µëœ Cron ìŠ¤ì¼€ì¤„**
- **íŒŒì¼:** `.github/workflows/crawl-volleyball.yml`
- **ë¬¸ì œ:** ë™ì¼í•œ cronì´ ë‘ ë²ˆ ë°˜ë³µë¨
- **í•´ê²°:** ì¤‘ë³µ ì œê±°

### 3. **Permissions ëˆ„ë½**
- **íŒŒì¼:** `crawl-volleyball.yml`, `crawl-major-events.yml`
- **ë¬¸ì œ:** Git push ê¶Œí•œì´ ì—†ì–´ ì‹¤íŒ¨ ê°€ëŠ¥
- **í•´ê²°:** `permissions: contents: write` ì¶”ê°€

### 4. **íŒŒì¼ ì¡´ì¬ í™•ì¸ ì—†ì´ Git Add ì‹œë„**
- **íŒŒì¼:** ëª¨ë“  workflow íŒŒì¼
- **ë¬¸ì œ:** í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•„ íŒŒì¼ì´ ìƒì„±ë˜ì§€ ì•ŠëŠ”ë° git add ì‹œë„
- **í•´ê²°:** íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•œ í›„ addí•˜ë„ë¡ ë¡œì§ ê°œì„ 

### 5. **í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸ ë¶€ì¬**
- **ë¬¸ì œ:** ëª¨ë“  í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
- **í•´ê²°:** í…œí”Œë¦¿ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±

---

## âœ… ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

### Workflow íŒŒì¼
1. `.github/workflows/crawl-baseball.yml`
   - Cron ìŠ¤ì¼€ì¤„ ìˆ˜ì •
   - Git commit ë¡œì§ ê°œì„ 

2. `.github/workflows/crawl-volleyball.yml`
   - ì¤‘ë³µ cron ì œê±°
   - Permissions ì¶”ê°€
   - Git commit ë¡œì§ ê°œì„ 

3. `.github/workflows/crawl-major-events.yml`
   - Permissions ì¶”ê°€
   - Git commit ë¡œì§ ê°œì„ 

### í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸
4. `crawl-baseball.js` (ì‹ ê·œ ìƒì„±)
   - ì•¼êµ¬ ë°ì´í„° í¬ë¡¤ë§ í…œí”Œë¦¿
   - KBO ìˆœìœ„, ì„ ìˆ˜ ê¸°ë¡ ìˆ˜ì§‘ êµ¬ì¡°

5. `crawl-volleyball.js` (ì‹ ê·œ ìƒì„±)
   - ë°°êµ¬ ë°ì´í„° í¬ë¡¤ë§ í…œí”Œë¦¿
   - V-ë¦¬ê·¸ ìˆœìœ„, ê²½ê¸° ê²°ê³¼ ìˆ˜ì§‘ êµ¬ì¡°

6. `crawl-major-events.js` (ì‹ ê·œ ìƒì„±)
   - ì£¼ìš” êµ­ì œ ìŠ¤í¬ì¸  ì´ë²¤íŠ¸ í¬ë¡¤ë§ í…œí”Œë¦¿

### ì„¤ì • íŒŒì¼
7. `package.json`
   - í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ëª…ë ¹ì–´ ì¶”ê°€
   - `crawl:baseball`, `crawl:volleyball`, `crawl:events`, `crawl:all`

---

## ğŸ”„ Git Commit ë¡œì§ ê°œì„  ë‚´ì—­

### Before (ë¬¸ì œê°€ ìˆë˜ ì½”ë“œ)
```yaml
- name: Commit and push changes
  run: |
    git config --local user.email "action@github.com"
    git config --local user.name "GitHub Action"
    git add public/data/baseball-detail.json public/data/sports.json
    git diff --staged --quiet || (git commit -m "..." && git push)
```

**ë¬¸ì œì :**
- íŒŒì¼ì´ ì—†ìœ¼ë©´ `git add` ì‹¤íŒ¨
- ë¹ˆ ì»¤ë°‹ ìƒì„± ê°€ëŠ¥
- ì—ëŸ¬ ì²˜ë¦¬ ë¶€ì¡±

### After (ìˆ˜ì •ëœ ì½”ë“œ)
```yaml
- name: Commit and push changes
  run: |
    git config --local user.email "action@github.com"
    git config --local user.name "GitHub Action"
    
    # íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ë§Œ add ì‹œë„
    if [ -f public/data/baseball-detail.json ]; then
      git add public/data/baseball-detail.json
    fi
    if [ -f public/data/sports.json ]; then
      git add public/data/sports.json
    fi
    
    # ë³€ê²½ì‚¬í•­ì´ ìˆì„ ë•Œë§Œ ì»¤ë°‹ ë° í‘¸ì‹œ
    if ! git diff --staged --quiet; then
      git commit -m "chore: update baseball data [skip ci]"
      git push
    else
      echo "No changes to commit"
    fi
```

**ê°œì„  íš¨ê³¼:**
- âœ… íŒŒì¼ì´ ì—†ì–´ë„ ì—ëŸ¬ ì—†ì´ ì‹¤í–‰
- âœ… ë³€ê²½ì‚¬í•­ì´ ì—†ìœ¼ë©´ ì»¤ë°‹í•˜ì§€ ì•ŠìŒ
- âœ… ëª…í™•í•œ ë¡œê·¸ ë©”ì‹œì§€

---

## ğŸ“‚ ì ìš© ë°©ë²•

### 1. íŒŒì¼ êµì²´

ë¡œì»¬ í”„ë¡œì íŠ¸(`C:\Users\CNXK\Desktop\cursor\mysport`)ì˜ ë‹¤ìŒ íŒŒì¼ë“¤ì„ ìˆ˜ì •ëœ íŒŒì¼ë¡œ êµì²´:

```
mysport/
â”œâ”€â”€ .github/workflows/
â”‚   â”œâ”€â”€ crawl-baseball.yml      â† êµì²´
â”‚   â”œâ”€â”€ crawl-volleyball.yml    â† êµì²´
â”‚   â””â”€â”€ crawl-major-events.yml  â† êµì²´
â”œâ”€â”€ crawl-baseball.js           â† ìƒˆë¡œ ì¶”ê°€
â”œâ”€â”€ crawl-volleyball.js         â† ìƒˆë¡œ ì¶”ê°€
â”œâ”€â”€ crawl-major-events.js       â† ìƒˆë¡œ ì¶”ê°€
â””â”€â”€ package.json                â† êµì²´
```

### 2. Git Commit & Push

```bash
git add .
git commit -m "fix: GitHub Actions workflows ìˆ˜ì • ë° í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸ í…œí”Œë¦¿ ì¶”ê°€

- Cron ìŠ¤ì¼€ì¤„ ë¬¸ë²• ì˜¤ë¥˜ ìˆ˜ì •
- Git commit ë¡œì§ ê°œì„  (íŒŒì¼ ì¡´ì¬ í™•ì¸ ì¶”ê°€)
- Permissions ì¶”ê°€ (volleyball, major-events)
- í¬ë¡¤ë§ ìŠ¤í¬ë¦½íŠ¸ í…œí”Œë¦¿ ìƒì„±
- package.jsonì— í¬ë¡¤ë§ ëª…ë ¹ì–´ ì¶”ê°€"

git push origin main
```

### 3. GitHub Actions í™•ì¸

1. GitHub ì €ì¥ì†Œì˜ **Actions íƒ­** ì´ë™
2. ìµœê·¼ workflow ì‹¤í–‰ ìƒíƒœ í™•ì¸
3. âœ… ì„±ê³µ: ì´ì œ ì—ëŸ¬ ì—†ì´ ì™„ë£Œë¨
4. í•„ìš”ì‹œ **"Run workflow"**ë¡œ ìˆ˜ë™ ì‹¤í–‰ í…ŒìŠ¤íŠ¸

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

í˜„ì¬ workflowëŠ” **ì—ëŸ¬ ì—†ì´ ì‹¤í–‰**ë˜ì§€ë§Œ, ì‹¤ì œ í¬ë¡¤ë§ì€ ì•„ì§ ìˆ˜í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.  
ì‹¤ì œ ë°ì´í„° ìˆ˜ì§‘ì„ ìœ„í•´ ë‹¤ìŒ ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤:

### Phase 1: Puppeteer ì„¤ì¹˜
```bash
npm install puppeteer --save-dev
```

### Phase 2: í¬ë¡¤ë§ ë¡œì§ êµ¬í˜„
ê° ìŠ¤í¬ë¦½íŠ¸ì˜ `TODO` ë¶€ë¶„ì„ ì‹¤ì œ í¬ë¡¤ë§ ì½”ë“œë¡œ êµì²´:
- KBO ê³µì‹ ì‚¬ì´íŠ¸ í¬ë¡¤ë§
- V-ë¦¬ê·¸ ê³µì‹ ì‚¬ì´íŠ¸ í¬ë¡¤ë§
- êµ­ì œ ëŒ€íšŒ ì •ë³´ í¬ë¡¤ë§

### Phase 3: Workflow í™œì„±í™”
ê° workflow íŒŒì¼ì—ì„œ ì£¼ì„ í•´ì œ:
```yaml
# Before
# node crawl-baseball.js

# After
node crawl-baseball.js
```

### Phase 4: Chromium ì„¤ì¹˜ (GitHub Actions)
Workflowì— ì¶”ê°€:
```yaml
- name: Install Chromium
  run: |
    sudo apt-get update
    sudo apt-get install -y chromium-browser
```

---

## ğŸ“Š ì˜ˆìƒ ê²°ê³¼

### í˜„ì¬ ìƒíƒœ
- âœ… Workflow ì—ëŸ¬ í•´ê²°ë¨
- âœ… Git commit ì•ˆì •í™”
- â³ ì‹¤ì œ ë°ì´í„° í¬ë¡¤ë§ì€ ë¯¸êµ¬í˜„

### ìµœì¢… ëª©í‘œ
- âœ… ìë™ ìŠ¤ì¼€ì¤„ë§ (ì•¼êµ¬: í•˜ë£¨ 2íšŒ, ë°°êµ¬: í•˜ë£¨ 2íšŒ)
- âœ… ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸
- âœ… GitHub Pages ìë™ ë°°í¬
- âœ… ì—ëŸ¬ ì—†ì´ ì•ˆì •ì ì¸ ìš´ì˜

---

## ğŸ’¡ ì¶”ê°€ ê¶Œì¥ ì‚¬í•­

### 1. ì—ëŸ¬ ì•Œë¦¼ ì„¤ì •
```yaml
- name: Notify on failure
  if: failure()
  run: echo "Crawling failed - check logs"
```

### 2. ë°ì´í„° ê²€ì¦
í¬ë¡¤ë§ í›„ ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬:
```javascript
if (!data.team || !data.currentRank) {
  throw new Error('Invalid data structure');
}
```

### 3. Rate Limiting
ê³¼ë„í•œ í¬ë¡¤ë§ ë°©ì§€:
```javascript
await page.waitForTimeout(2000); // 2ì´ˆ ëŒ€ê¸°
```

### 4. Retry ë¡œì§
ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ ì¬ì‹œë„:
```javascript
const maxRetries = 3;
for (let i = 0; i < maxRetries; i++) {
  try {
    return await crawl();
  } catch (error) {
    if (i === maxRetries - 1) throw error;
    await sleep(5000); // 5ì´ˆ ëŒ€ê¸° í›„ ì¬ì‹œë„
  }
}
```

---

## ğŸ“ ë¬¸ì˜ ë° ì§€ì›

- ì¶”ê°€ ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ ì–¸ì œë“ ì§€ ìš”ì²­í•˜ì„¸ìš”
- í¬ë¡¤ë§ ë¡œì§ êµ¬í˜„ ì‹œ ë„ì›€ì´ í•„ìš”í•˜ë©´ ì•Œë ¤ì£¼ì„¸ìš”
- Puppeteer ì‚¬ìš©ë²•ì´ë‚˜ ì…€ë ‰í„° ì°¾ê¸°ë„ ë„ì™€ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤

---

**ìˆ˜ì • ì™„ë£Œì¼:** 2025-01-14  
**ì‘ì„±ì:** Claude
